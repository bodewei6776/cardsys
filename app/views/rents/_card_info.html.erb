<% current_card = @rent.member_card || MemberCard.new%>
<% member = @rent.member || Member.new(:name => @rent.member_name)%>
<% date = @rent.start_date%>
<ul>
  <li>
  <div class="w1">预定人：</div>
  <div class="w2"><%= text_field_tag "rent[member_name]" ,(member.name rescue ""),:rent_autocomplete=>'/book_records/complete_for_members'%></div>
  </li>
  <li>
  <div class="w1"> 会员卡号：</div>
  <% if @cards.present? %>
    <div class="w2"><%= select_tag "rent[card_num]",options_from_collection_for_select(cards,:id,:card_serial_num,current_card.id),:onchange=>'card_num_change();',:id => "card_num"%></div>
<%else%>
  <div class="w2"><%= text_field_tag "rent[card_num]",current_card.card_serial_num,:rent_autocomplete=>'/book_records/complete_for_member_card'%></div>
<%end%>
  </li>
</ul>
  <ul>
    <li>
    <div class="w1">卡类型：</div>
    <div class="w2">
      &nbsp;
      <%= current_card.card.card_type_desc if current_card.card %>
    </div>
    <div class="w1">卡内余额(次)：</div>
    <div class="w2">
      &nbsp;
      <%= current_card.left_fee_value unless current_card.new_record?%>
    </div>
    </li>
  </ul>
  <ul>
    <li>
    <div class="w1">卡状态：</div>
    <div class="w2">
      &nbsp;
      <%= current_card.status_desc unless current_card.new_record? %>
      <% if !current_card.new_record? && current_card.should_notice_remain_amount_due?(date)  %>
        <p style='color:red;display:inline;'><%= current_card.remain_amount_notice(date) unless current_card.new_record?%></p>
      <%end%>
    </div>
    <div class="w1">联系电话：</div>
    <div class="w2">
      <input type="text" name="telephone"  value="<%= member.mobile rescue "" %>" />
      <input type="hidden" name="rent[card_id]" value="<%= current_card.id %>" />
    </div>
    </li>
  </ul>
  <script type='text/javascript'>
    $(document).ready(function(){
        rentAutocomplete();
        });
      </script>
